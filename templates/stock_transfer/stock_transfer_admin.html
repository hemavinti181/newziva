{% extends 'base.html' %}

{% block htmlbody %}

<style>
	.style1{
	position: absolute !important;
	width: 60% !important;
	margin-left:70px !important;
	}
</style>

<div class="right_col" role="main">
          <div class="">
            <div class="page-title">
              <div class="title_left">
                <h3 style="color:#1372ba"> <b>Stock Transfer </b></h3>
              </div>
              <div class="title_right">
                <div class="col-md-6 col-sm-7 offset-md-9">
					<!--<a href="indent_list"><button type="submit" class="btn btn-primary">Indent List</button></a>-->
                </div>

            </div>
              </div>

            <div class="clearfix"></div>
             <div class="row">
              <div class="col-md-12 col-sm-12 ">
                <div class="x_panel">
                 <div class="x_content">
                     <div class="">

									<br />
                                        	<div class="col-md-3 col-sm-3  form-group has-feedback">
												 <input type="hidden" id="whr" name="whr" />
                                                <input type="hidden" id="whname" name="whname" />
											    <label>Stock Transfer From *</label>
                                                     <select class="form-control items" name="wh" id="wh" required>
                                                         <option value="">Select</option>
                                                                 <option value="Warehouse">Warehouse</option>
                                                               <option value="Depot">Depot</option>
                                                         <option value="Busstation">Busstation</option>
                                                    </select>
										    </div>
                 </div>
                 </div>
                </div>
              </div>

              <div class="col-md-12 col-sm-12 ">
                <div class="x_panel warehouse-div" style="display:none;">
									<br />
									<form class="form-label-left input_mask" id="myform"  method="POST" action="/generate_transid"   enctype="multipart/form-data">
										{% csrf_token %}
                                        <div class="col-md-3 col-sm-3  form-group has-feedback">
                                            <input type="hidden" name="actionname" id="actionname" />
                                             <input type="hidden" name="response" id="response"  value="{{ response }}"/>
                                             <input type="hidden" name="status" id="status"  value="{{ status }}"/>

											<label>Stock Transfer From  *</label>
                                            <select class="form-control" name="wh2" id="wh2" hidden>
                            		                    <option value="{{ wh_code  }}">{{ wh_code }}</option>
												    </select>
                                                   <input type="hidden" name="whname1" id="whname1" />
										    	 <select class="form-control items" name="wh1" id="wh1" required>
                                                     <option value="">select warehouse</option>
                                                </select>
										</div>


                                        <div class="col-md-3 col-sm-3  form-group has-feedback">
											<label>Stock Transfer To *</label>
                                             <select class="form-control" name="depocode2" id="depocode2" hidden>
                            		                    <option value="{{ depocode1 }}">{{ depocode1  }}</option>
												    </select>
                                            <input type="hidden" name="deponame1" id="deponame1" />
                                            <select class="form-control items" name="depocode1" id="depocode1" required>
                                                     <option value="">select depot</option>
                                                </select>
                                        </div>

                                        <div class="col-md-6 col-sm-2 form-group has-feedback">
												<button type="submit"  style="margin-top: 28px;"  class="btn btn-primary">Submit</button>
                                        </div>
                                    </form>
                </div>
              </div>

              <div class="col-md-12 col-sm-12 ">
                <div class="x_panel depot-div" style="display:none;">
									<br />
									<form class="form-label-left input_mask" id="depoform"  method="POST" action="/generate_transid_depo"   enctype="multipart/form-data">
										{% csrf_token %}
                                        <div class="col-md-3 col-sm-3  form-group has-feedback">
                                            <input type="hidden" name="actionname" id="actionname1" />
											<label>Stock Transfer From  *</label>
                                            <select class="form-control" name="depotid3" id="depotid3" hidden>
                            		                    <option value="{{ fromid }}">{{ fromid }}</option>
												    </select>
                                                 <input type="hidden" name="depotname" id="depotname" />
										    	 <select class="form-control items" name="depotid2" id="depotid2" required>
                                                     <option value="">select depot</option>
                                                </select>
										</div>
                                        <div class="col-md-3 col-sm-3  form-group has-feedback" id="depowhbus">
											<label>Stock Transfer To *</label>
                                              <select class="form-control" name="depotransfer2" id="depotransfer2" hidden>
                            		                    <option value="{{ toid }}">{{ toid }}</option>
                                              </select>
                                            <input type="hidden" name="depotransfer" id="depotransfer" />
                                            <select class="form-control items" name="depotransfer1" id="depotransfer1" required>
                                                     <option value="">select</option>
                                                     <option value="Warehouse">Warehouse</option>
                                                     <option value="Bus station">Bus station</option>
                                                </select>
                                        </div>
                                        <div class="col-md-3 col-sm-3  form-group has-feedback" id="depo" style="display:none;">
											<label>Stock Transfer To  *</label>
                                            <select class="form-control" name="warehouse" id="warehouse" hidden>
                            		                    <option value="{{ toid }}">{{ toid }}</option>
												    </select>
                                                   <input type="hidden" name="warehousename" id="warehousename" />
										    	 <select class="form-control items" name="warehouseid" id="warehouseid" required>
                                                     <option value="">select</option>
                                                </select>
										</div>
                                        <div class="col-md-3 col-sm-3  form-group has-feedback" id="bus" style="display:none;">
                                             <select class="form-control" name="bustid1" id="bustid1" hidden>
                            		                    <option value="{{ toid }}">{{ toid }}</option>
												    </select>
											<label>Stock Transfer To  *</label>
                                                   <input type="hidden" name="bustname" id="bustname" />
										    	 <select class="form-control items" name="bustid" id="bustid" required>
                                                     <option value="">select</option>
                                                 </select>
										</div>
                                        <div class="col-md-3 col-sm-3 form-group has-feedback">
												<button type="submit"  style="margin-top: 28px;"  class="btn btn-primary">Submit</button>
                                        </div>
                                    </form>
                </div>
              </div>
                 <div class="col-md-12 col-sm-12 ">
       <div class="x_panel" id="items-div"  style="display:none;">
           	<form class="form-label-left input_mask"  method="POST" action="/wh_item_add_admin"   enctype="multipart/form-data">
										{% csrf_token %}
										<div class="col-md-4 col-sm-4  form-group has-feedback">
                                              <input id="whitemname" name="whitemname" type="hidden"/>
                                             <input id="freequantity" name="freequantity" type="hidden"/>
                                             <input id="whexpdate" name="whexpdate" type="hidden"/>
                                             <input id="whbatchno" name="whbatchno" type="hidden"/>
                                             <input id="whcp_sno" name="whcp_sno" type="hidden"/>
                                            <input id="whuom" name="whuom" type="hidden"/>
                                            <input id="whnob" name="whnob" type="hidden"/>
                                            <input id="whexpirydate" name="whexpirydate" type="hidden"/>
											<label>Select Items *</label>
										    	 <select class="form-control select2" name="itemcode1" id="itemcode1" required>
													<option value="">Items</option>

                                                </select>
										</div>
                                        	 <div class="col-md-2 col-sm-2 input-icons  form-group has-feedback">
                                            <label>Type</label>
                                            <input id="typename" name="typename" type="hidden"/>
                                            <select class="form-control items" id="typeid" name="typeid" required>
                                                <option value="">Type</option>
                                                {% for data1 in type %}
                                                <option value="{{ data1.type }}">{{ data1.type }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                        <div class="col-md-2 col-sm-2 form-group has-feedback">
                                            <label>Qty(Cases) </label>
                                            <input class="form-control" id="quantity" name="quantity"
                                                   placeholder="cases"
                                                   type="number" required>
                                        </div>
                                        <div class="col-md-2 col-sm-2 form-group has-feedback">
                                            <label>Qty(Bottles)</label>
                                            <input class="form-control" id="nob" name="nob" placeholder="bottles"
                                                   type="text" required>
                                        </div>
										 <div class="col-md-2 col-sm-2  form-group has-feedback">
                                            <button class="btn btn-primary" name="add" style="margin-top: 30px;"
                                                    type="submit">Add </button>
                                         </div>

            </form>
        </div>
 </div>

                 <div class="col-md-12 col-sm-12 ">
                <div class="x_panel bus_div" style="display:none">
									<br />
									<form class="form-label-left input_mask"  method="POST" action="/generate_transid_bust"   enctype="multipart/form-data">
										{% csrf_token %}
                                        <div class="col-md-3 col-sm-3  form-group has-feedback">

                                             <select class="form-control" name="busid2" id="busid2" hidden>
                            		                    <option value="{{busid1 }}">{{ busid1 }}</option>
												    </select>
											<label>Stock Transfer From  *</label>
                                                   <input type="hidden" name="busname1" id="busname1" />
										    	 <select class="form-control items" name="busid1" id="busid1" required>
                                                     <option value="">select busstation</option>

                                                </select>
										</div>
                                        <div class="col-md-3 col-sm-3  form-group has-feedback">
                                               <select class="form-control" name="depotid1" id="depotid1" hidden>
                            		                    <option value="{{ depotid }}">{{ depotid }}</option>
												    </select>
											<label>Stock Transfer To *</label>
                                            <input type="hidden" name="depotname1" id="depotname1" />
                                            <select class="form-control items" name="depotid" id="depotid" required>
                                                     <option value="">select depot</option>
                                                </select>
                                        </div>
                                        <div class="col-md-6 col-sm-2 form-group has-feedback">
												<button type="submit"  style="margin-top: 28px;"  class="btn btn-primary">Submit</button>
                                        </div>
                                    </form>
                </div>
     </div>

                  <div class="x_panel"  style="display:none;"  id="divItemsAdd">
                   <div class="x_content">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="card-box table-responsive">
                                                <p class="text-muted font-13 m-b-30">
                                                </p>

                                                <table class="display  table-bordered" id="datatable"
                                                       style="width:100%">
                                                    <thead>
                                                    <tr>
                                                        <th>S No</th>
                                                        <th>Item Name</th>
                                                        <th>Qty(Cases)</th>
                                                        <th>Qty(Bottles)</th>
                                                        <th>Expiry Date</th>
                                                        <!--<th>HSN</th>-->
                                                        <th>Batch</th>
                                                        <!--<th>MRP</th>-->
                                                        <th>Manufacture</th>
                                                        <th>Action</th>

                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    {% for all_data in wh_item_list %}
                                                    <tr>
                                                        <td>{{ forloop.counter }}</td>
                                                        <td>{{ all_data.item_name }}</td>
                                                        <td> {{ all_data.quantity }}</td>
                                                        <td>{{ all_data.noofbottles }}</td>
                                                        <td>{{ all_data.expiry_date }}</td>
                                                        <!--<td>{{ all_data.hsn }}</td>-->
                                                        <td>{{ all_data.batch_no }}</td>
                                                        <!--<td>{{ all_data.mrp }}</td>-->
                                                        <td>{{all_data.manufacturer}}</td>

                                                        <td>
                                                              <a
                                                               href="#"><span class="badge badge-danger wh-delete" data-sno="{{ all_data.sno }}" data-toggle="modal" data-target="#store-status"><i
                                                                    class="fa fa-trash"></i></span></a>
                                                            <span class="badge badge-info wh_edit"
                                                                  data-target="#edit_stk_item"
                                                                  data-toggle="modal"
                                                                  onclick="VerifyClick('{{ all_data.quantity }}','{{ all_data.sno }}','{{ all_data.item_name }}','{{ all_data.uom }}','{{ all_data.type }}','{{ all_data.noofbottles }}')"><i
                                                                    class="fa fa-edit"></i></span>

                                                        </td>
                                                    </tbody>
                                                    {% endfor %}

                                                     {% if status == 'ok' %}
                                                    <tr>
                                                    <td colspan="9" style="color:#06911A">
                                                        <b>Invoice No: {{ taxinvoice }}</b>

                                                            <span style="float:right;"><span class="badge-warning"
                                                                                             data-target="#complete"
                                                                                             data-toggle="modal"
                                                                                             onclick="VerifyClick('{{data.so_number}}')"
                                                                                             style="padding:  4px !important;">COMPLETE TRANSFER</span></span>
                                                        {% endif %}
                                                    </tr>

                                                </table>

                                            </div>
                                        </div>
                                    </div>
                   </div>
                  </div>


<div class="col-md-12 col-sm-12 ">
       <div class="x_panel" id="items-depot"  style="display:none;">
           	<form class="form-label-left input_mask"  method="POST" action="/depot_item_add_admin"   enctype="multipart/form-data">
										{% csrf_token %}
										<div class="col-md-3 col-sm-3  form-group has-feedback">
                                              <input id="depot_name" name="depot_name" type="hidden"/>
                                             <input id="depotexpdate" name="depotexpdate" type="hidden"/>
                                             <input id="depotbatchno" name="depotbatchno" type="hidden"/>
                                             <input id="depot_sno" name="depot_sno" type="hidden"/>
                                            <input id="depot_uom" name="depot_uom" type="hidden"/>
                                            <input id="depot_nob" name="depot_nob" type="hidden"/>
                                              <input id="depot_mrp" name="depot_mrp" type="hidden"/>

											<label>Select Items *</label>
										    	 <select class="form-control select2" name="depot_itemcode" id="depot_itemcode" required>
													<option value="">Items</option>

                                                </select>
										</div>
                                        	 <div class="col-md-2 col-sm-2 input-icons  form-group has-feedback">
                                            <label>Type</label>
                                            <input id="depot_typename" name="depot_typename" type="hidden"/>
                                            <select class="form-control items" id="depot_typeid" name="depot_typeid" required>
                                                <option value="">Type</option>
                                                {% for data1 in type %}
                                                <option value="{{ data1.type }}">{{ data1.type }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                        <div class="col-md-2 col-sm-2 form-group has-feedback">
                                            <label>Qty(Cases) </label>
                                          <input class="form-control" id="depot_quantity" name="depot_quantity" placeholder="cases"
       type="number" title="Please enter numbers only" required>

                                        </div>
                                        <div class="col-md-2 col-sm-2 form-group has-feedback">
                                            <label>Qty(Bottles)</label>
                                            <input class="form-control" id="depot_nobt" name="depot_nobt" placeholder="Bottles" type="text" pattern="^[0-9]+$" title="Please enter numbers only">

                                        </div>
										 <div class="col-md-2 col-sm-2  form-group has-feedback">
                                            <button class="btn btn-primary" name="add" style="margin-top: 30px;"
                                                    type="submit">Add
                                            </button>
                                        </div>

                </form>
</div>
</div>


<div class="col-md-12 col-sm-12 ">
                    <div class="x_panel"  style="display:none;"  id="depot_items">
                   <div class="x_content">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="card-box table-responsive">
                                                <p class="text-muted font-13 m-b-30">
                                                </p>

                                                <table class="display  table-bordered" id="datatable-buttons1"
                                                       style="width:100%">
                                                    <thead>
                                                    <tr>
                                                        <th>S No</th>
                                                        <th>Item Name</th>
                                                        <th>Qty(Cases)</th>
                                                        <th>Qty(Bottles)</th>
                                                        <th>Expiry Date</th>
                                                        <!--<th>HSN</th>-->
                                                        <th>Batch</th>
                                                        <!--<th>MRP</th>-->
                                                        <th>Manufacture</th>
                                                        <th>Action</th>

                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    {% for all_data in wh_item_list %}
                                                    <tr>
                                                        <td>{{ forloop.counter }}</td>
                                                        <td>{{ all_data.item_name }}</td>
                                                        <td> {{ all_data.quantity }}</td>
                                                        <td>{{ all_data.noofbottles }}</td>
                                                        <td>{{ all_data.expiry_date }}</td>
                                                        <!--<td>{{ all_data.hsn }}</td>-->
                                                        <td>{{ all_data.batch_no }}</td>
                                                        <!--<td>{{ all_data.mrp }}</td>-->
                                                        <td>{{all_data.manufacturer}}</td>

                                                        <td>
                                                              <a
                                                               href="#"><span class="badge badge-danger depot_delete" data-sno="{{ all_data.sno }}" data-toggle="modal" data-target="#store-status"><i
                                                                    class="fa fa-trash"></i></span></a>
                                                            <span class="badge badge-info depo_edit"
                                                                  data-target="#edit_stk_item"
                                                                  data-toggle="modal"
                                                                  onclick="VerifyClick('{{ all_data.quantity }}','{{ all_data.sno }}','{{ all_data.item_name }}','{{ all_data.uom }}','{{ all_data.type }}','{{ all_data.noofbottles }}')"><i
                                                                    class="fa fa-edit"></i></span>

                                                        </td>
                                                    </tbody>
                                                    <tfoot>

                                                    </tfoot>
                                                    </tfoot>
                                                    </tr>
                                                    {% endfor %}


                                                    <tbody>
                                                    </tbody>
                                                     {% if status == 'ok' %}
                                                    <td colspan="9" style="color:#06911A">
                                                        <b>Invoice No: {{ taxinvoice }}</b>

                                                            <span style="float:right;"><span id="depotcomplete" class="badge-warning"
                                                                                             data-target="#complete"
                                                                                             data-toggle="modal"
                                                                                             onclick="VerifyClick('{{data.so_number}}')"
                                                                                             style="padding:  4px !important;">COMPLETE TRANSFER</span></span>
                                                        {% endif %}
                                                    </th>
                                                    </tr>
                                                    </tfoot>
                                                </table>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                    </div>
</div>


    <div class="col-md-12 col-sm-12 ">
       <div class="x_panel" id="items-bus"  style="display:none;">
           	<form class="form-label-left input_mask"  method="POST" action="/bust_item_add_admin"   enctype="multipart/form-data">
										{% csrf_token %}
										<div class="col-md-4 col-sm-4  form-group has-feedback">
                                              <input id="busname" name="busname" type="hidden"/>
                                             <input id="busexpdate" name="busexpdate" type="hidden"/>
                                             <input id="busbatchno" name="busbatchno" type="hidden"/>
                                             <input id="buscp_sno" name="buscp_sno" type="hidden"/>
                                            <input id="busuom" name="busuom" type="hidden"/>
                                            <input id="busnob" name="busnob" type="hidden"/>

											<label>Select Items *</label>
										    	 <select class="form-control select2" name="busitemcode" id="busitemcode" required>
													<option value="">Items</option>

                                                </select>
										</div>
                                        	 <div class="col-md-2 col-sm-2 input-icons  form-group has-feedback">
                                            <label>Type</label>
                                            <input id="bustypename" name="bustypename" type="hidden"/>
                                            <select class="form-control items" id="bustypeid" name="bustypeid" required>
                                                <option value="">Type</option>
                                                {% for data1 in type %}
                                                <option value="{{ data1.type }}">{{ data1.type }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                        <div class="col-md-2 col-sm-2 form-group has-feedback">
                                            <label>Qty(Cases) </label>
                                            <input class="form-control" id="busquantity" name="busquantity"
                                                   placeholder="cases"
                                                   type="number" required>
                                        </div>
                                        <div class="col-md-2 col-sm-2 form-group has-feedback">
                                            <label>Qty(Bottles)</label>
                                            <input class="form-control" id="busnobt" name="busnobt" placeholder="bottles"
                                                   type="text">
                                        </div>
										 <div class="col-md-2 col-sm-2  form-group has-feedback">
                                            <button class="btn btn-primary" name="add" style="margin-top: 30px;"
                                                    type="submit">Add
                                            </button>
                                        </div>
                </form>
    </div>
</div>

<div class="col-md-12 col-sm-12 ">
                    <div class="x_panel"  style="display:none;"  id="bust_items">
                   <div class="x_content">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="card-box table-responsive">
                                                <p class="text-muted font-13 m-b-30">
                                                </p>

                                                <table class="display  table-bordered" id="datatable-buttons"
                                                       style="width:100%">
                                                    <thead>
                                                    <tr>
                                                        <th>S No</th>
                                                        <th>Item Name</th>
                                                        <th>Qty(Cases)</th>
                                                        <th>Qty(Bottles)</th>
                                                        <th>Expiry Date</th>
                                                        <!--<th>HSN</th>-->
                                                        <th>Batch</th>
                                                        <!--<th>MRP</th>-->
                                                        <th>Manufacture</th>
                                                        <th>Action</th>

                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    {% for all_data in bus_item_list %}
                                                    <tr>
                                                        <td>{{ forloop.counter }}</td>
                                                        <td>{{ all_data.item_name }}</td>
                                                        <td> {{ all_data.quantity }}</td>
                                                        <td>{{ all_data.noofbottles }}</td>
                                                        <td>{{ all_data.expiry_date }}</td>
                                                        <!--<td>{{ all_data.hsn }}</td>-->
                                                        <td>{{ all_data.batch_no }}</td>
                                                        <!--<td>{{ all_data.mrp }}</td>-->
                                                        <td>{{all_data.manufacturer}}</td>

                                                        <td>
                                                              <a
                                                               href="#"><span class="badge badge-danger bus_delete" data-sno="{{ all_data.sno }}" data-toggle="modal" data-target="#store-status" ><i
                                                                    class="fa fa-trash"></i></span></a>
                                                            <span class="badge badge-info bus_edit"
                                                                  data-target="#edit_stk_item"
                                                                  data-toggle="modal"
                                                                  onclick="VerifyClick('{{ all_data.quantity }}','{{ all_data.sno }}','{{ all_data.item_name }}','{{ all_data.uom }}','{{ all_data.type }}','{{ all_data.noofbottles }}')"><i
                                                                    class="fa fa-edit"></i></span>

                                                        </td>
                                                    </tbody>

                                                    {% endfor %}


                                                     {% if status == 'ok' %}
                                                    <tr>
                                                    <td colspan="9" style="color:#06911A">
                                                        <b>Invoice No: {{ taxinvoice }}</b>

                                                            <span style="float:right;"><span id="buscomplete" class="badge-warning"
                                                                                             data-target="#complete"
                                                                                             data-toggle="modal"
                                                                                             onclick="VerifyClick('{{data.so_number}}')"
                                                                                             style="padding:  4px !important;">COMPLETE TRANSFER</span></span>
                                                        {% endif %}

                                                    </tr>

                                                </table>

                                            </div>
                                        </div>
                                    </div>
                                </div>

                    </div>
                </div>
             </div>
          </div>
</div>


<div class="modal custom-modal fade" id="complete" role="dialog">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content style1">
            <div class="modal-header">
                <h3 class="modal-title"  id="myModalLabel1">Complete Transfer</h3>
                <button aria-label="Close" class="close" data-dismiss="modal" type="button">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="/complete_stk_admin" id="completeform" method="POST">
                    {% csrf_token %}
                    <input id="txtHdnId" name="txtHdnId" type="hidden"/>

                    <div class="col-md-12 col-sm-12  form-group has-feedback">
                        <label for="remarks">Remarks</label>

                        <textarea class="form-control" id="remarks" name="remarks" placeholder="remarks"></textarea>
                        <p></p>
                    </div>
                    <div class="col-md-6 col-sm-6  offset-md-3">
                        <button class="btn btn-primary" name="complete"  type="submit">Complete</button>
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>

<div class="modal custom-modal fade" id="store-status" role="dialog">
					<div class="modal-dialog modal-dialog-centered">
						<div class="modal-content style1">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
									<span aria-hidden="true">&times;</span>
								</button>
							<div class="modal-body">
								  <form method="post" action="" id="myForm1">
                                                    {% csrf_token %}
								<div class="form-header">
									<h3>Delete  Item</h3>
									<p>Are you sure want to Delete?</p>
								</div>
									  <div class="modal-btn delete-action">
									<input type="hidden" id="sno" name="sno"  />
									<div class="row">
											<div class="col-md-6 col-sm-6">
                                                 <button type="submit"  id="modalLink" class="btn btn-primary" style="margin-left:50px;" >Yes</button>
                                        </div>
                                        	<div class="col-md-6 col-sm-6">
                                                 <button type="button" class="btn btn-danger" data-dismiss="modal">No</button>
                                            </div>
									</div>
								</div>
								  </form>
							</div>

						</div>
					</div>
				</div>

<div aria-hidden="true" class="modal custom-modal fade" id="edit_stk_item" role="dialog" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content style">
            <div class="modal-header">
                <h3 style="text-align:center;">Edit Transfer Item</h3>
                <button aria-label="Close" class="close" data-dismiss="modal" type="button">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">
                <form action=" " id="editForm" method="post">
                    {% csrf_token %}

                    <div class="col-md-12 col-sm-12  form-group has-feedback"  style="margin-top: -50px;" >
                        <label>Item Name </label>
                        <input class="form-control" id="item" name="item"  type="text" readonly>
                    </div>
                    <div class="col-md-6 col-sm-6 form-group has-feedback">
                        <label>Qty(In Cases)</label>
                        <input type="text" class="form-control" id="qty" name="qty" required>
                    </div>
                    <div class="col-md-6 col-sm-6 form-group has-feedback"  style="margin-bottom: 30px;">
                        <label>Qty(In Bottles)</label>
                        <input class="form-control" id="nob1" name="nob1" type="text" required>
                    </div>

                    <input id="cases" name="cases" type="hidden"/>

                    <input id="edituom" name="edituom" type="hidden"/>
                    <input id="typebus" name="typebus" type="hidden"/>
                    <input id="editsno" name="editsno" type="hidden"/>
                    <p></p>
                    <div class="col-md-6 col-sm-6  offset-md-4">
                        <button class="btn btn-primary" type="submit">Update</button>
                    </div>
                </form>
            </div>


        </div>
    </div>
</div>

<script>
function VerifyClick(id,id1,id2,id3,id4,id5){
$("#qty").val(id);
$("#editsno").val(id1);
$("#item").val(id2);
$("#edituom").val(id3);
$("#nob1").val(id5);
$("#typebus").val(id4);
      if (id4 === "Bottles") {
        $("#qty").prop("readonly", true);
        $("#nob1").prop("readonly", false);
      } else if (id4 === "Cases") {
        $("#qty").prop("readonly", false);
        $("#nob1").prop("readonly", true);
      }
}


$('#qty').on('input', function()  {
    	    val  = $("#qty").val();
            val1 = $("#edituom").val();
            val2 =    (val * val1)
            $("#nob1").val(val2);
    });
 $('#nob1').on('input', function() {
                $("#qty").val(" ");
                val = parseFloat($("#nob1").val()); // Convert to a float to handle decimals
                val1 = $("#edituom").val();
                val2 = val / val1;
                if (Number.isInteger(val2)) {
                    val2 = val2.toFixed(0); // For integers, remove decimal places
                } else {
                    val2 = val2.toFixed(2); // For decimal values, keep two decimal places
                }
                $("#qty").val(val2);
         });

$('.bus_edit').click(function(){
      $('#editForm').attr('action', '{% url "edit_stkbus_item" %}'); // set the new action URL
});
$('.depo_edit').click(function(){
      $('#editForm').attr('action', '{% url "edit_stkdepo_item" %}'); // set the new action URL
});
$('.wh_edit').click(function(){
      $('#editForm').attr('action', '{% url "edit_stk_item" %}'); // set the new action URL
});

$("#wh1").change(function() {
  var selectedOptionText = $(this).find(":selected").text();
  $("#whname1").val(selectedOptionText);
});
$("#itemcode").change(function() {
  var selectedOptionText = $(this).find(":selected").text();
  $("#itemname2").val(selectedOptionText);
});
$("#buscode").change(function() {
  var selectedOptionText = $(this).find(":selected").text();
  $("#busname").val(selectedOptionText);
});
$("#bustid").change(function() {
  var selectedOptionText = $(this).find(":selected").text();
  $("#bustname").val(selectedOptionText);
});

$("#busid1").change(function() {
  var selectedOptionText = $(this).find(":selected").text();
  $("#busname1").val(selectedOptionText);
});

$("#depotid").change(function() {
  var selectedOptionText = $(this).find(":selected").text();
  $("#depotname1").val(selectedOptionText);
});
$("#depocode").change(function() {
  var selectedOptionText = $(this).find(":selected").text();
  $("#deponame").val(selectedOptionText);
});

$("#itemcode1").change(function() {
  var selectedOptionText = $(this).find(":selected").text();
  $("#itemname1").val(selectedOptionText);
});

$("#depocode1").change(function() {
  var selectedOptionText = $(this).find(":selected").text();
  $("#deponame1").val(selectedOptionText);
});

$("#depotid2").change(function() {
  var selectedOptionText = $(this).find(":selected").text();
  $("#depotname").val(selectedOptionText);
});

$("#warehouseid").change(function() {
  var selectedOptionText = $(this).find(":selected").text();
  $("#warehousename").val(selectedOptionText);
});

	$(document).ready(function() {
	    var response = $('#response').val();
        $.ajax({
            type: "POST",
            url: '{% url "stk_warehouse_list" %}',
            data: {
                'csrfmiddlewaretoken': '{{ csrf_token }}',
            },
            success: function(data) {
                var obj = data.data.warehouselist
                if (obj) {
                    $.each(obj, function(index, item) {
                        $("#wh1").append("<option value='" + item.warehouseid + "'>" + item.warehousename + "</option>");
                         $("#warehouseid").append("<option value='" + item.warehouseid + "'>" + item.warehousename + "</option>");
                    });
                 if (response === "200") {
                    var optionValue1 = $("#wh2").val();
                    $("#wh1").find("option[value='" + optionValue1 + "']").prop("selected", true);
                     var optionValue2 = $("#wh").val();
                    $("#wh").find("option[value='" + optionValue2 + "']").prop("selected", true);
                 }
                  if (response === "depo200") {
                    var optionValue1 = $("#warehouse").val();
                    $("#warehouseid").find("option[value='" + optionValue1 + "']").prop("selected", true);
                 }
                  if (response === "depo200") {
                    var optionValue1 = $("#depotransfer2").val();

                 }
                }
            }
        });
    });

    $(document).ready(function() {
        var response = $('#response').val();

        $.ajax({
            type: "POST",
            url: '{% url "stk_depot_list" %}',
            data: {
                'csrfmiddlewaretoken': '{{ csrf_token }}',
            },
            success: function(data) {
                var obj = data.data.depolist
                if (obj) {

                    $.each(obj, function(index, item) {
                         if (item.status === "Active") {
                            $("#depocode1").append("<option value='" + item.depoid + "'>" + item.deponame + "</option>");
                            $("#depotid").append("<option value='" + item.depoid + "'>" + item.deponame + "</option>");
                            $("#depotid2").append("<option value='" + item.depoid + "'>" + item.deponame + "</option>");
                         }
                    });
                     if (response === "200") {
                        var optionValue = $("#depocode2").val();
                        $("#depocode1").find("option[value='" + optionValue + "']").prop("selected", true);
                     }
                     if (response === "Bus200") {
                        var optionValue = $("#depotid1").val();
                        $("#depotid").find("option[value='" + optionValue + "']").prop("selected", true);
                     }
                      if (response === "depo200") {
                        var optionValue = $("#depotid3").val();
                        $("#depotid2").find("option[value='" + optionValue + "']").prop("selected", true);
                     }
                }
            }
        });
    });


    $(document).ready(function() {
       var response = $('#response').val();
        $.ajax({
            type: "POST",
            url: '{% url "stk_busstation_list" %}',
            data: {
                'csrfmiddlewaretoken': '{{ csrf_token }}',
            },
            success: function(data) {
                var obj = data.data.buslist
                if (obj) {

                    $.each(obj, function(index, item) {
                         if (item.status === "Active") {
                            $("#busid1").append("<option value='" + item.busatationid + "'>" + item.busstationname + "</option>");
                             $("#bustid").append("<option value='" + item.busatationid + "'>" + item.busstationname + "</option>");
                         }
                    });
                     if (response === "Bus200") {
                        var optionValue = $("#busid2").val();

                        $("#busid1").find("option[value='" + optionValue + "']").prop("selected", true);
                     }
                     if (response === "depo200") {
                        var optionValue = $("#bustid1").val();
                        $("#bustid").find("option[value='" + optionValue + "']").prop("selected", true);
                     }
                }
            }
        });
    });


    $(document).ready(function() {
        $.ajax({
            type: "POST",
            url: '{% url "warehouseinventory_search" %}',
            data: {
                'csrfmiddlewaretoken': '{{ csrf_token }}',
            },
            success: function(data) {
                var obj = data.data.warehouseinventorylist;
                console.log(obj[0].itemname);
                if (obj) {
                    var $select = $('#itemcode1');

                    $.each(obj, function(index, item) {
                            var optionText = `${item.itemname} (Batch: ${item.batchcode}, Expiry: ${item.expirydate}, MRP: ${item.mrp})`;
                            var $option = $('<option>', { value: item.itemcode, text: optionText });
                            $select.append($option);

                    });
                    $select.select2();
                }
            }
        });
    });

 $(document).ready(function() {
        $.ajax({
            type: "POST",
            url: '{% url "depotinventory_search" %}',
            data: {
                'csrfmiddlewaretoken': '{{ csrf_token }}',
            },
            success: function(data) {
                var obj = data.data.warehouseinventorylist;
                console.log(obj[0].itemname);
                if (obj) {
                    var $select = $('#depot_itemcode');
                    $.each(obj, function(index, item) {
                            var optionText = `${item.itemname} (Batch: ${item.batchcode}, Expiry: ${item.expirydate}, MRP: ${item.mrp})`;
                            var $option = $('<option>', { value: item.itemcode, text: optionText });
                            $select.append($option);

                    });
                    $select.select2();
                }
            }
        });
    });


$(document).ready(function() {
        $.ajax({
            type: "POST",
            url: '{% url "businventory_search" %}',
            data: {
                'csrfmiddlewaretoken': '{{ csrf_token }}',
            },
            success: function(data) {
                var obj = data.data.warehouseinventorylist;
                console.log(obj[0].itemname);
                if (obj) {
                    var $select = $('#busitemcode');

                    $.each(obj, function(index, item) {

                            var optionText = `${item.itemname} (Batch: ${item.batchcode}, Expiry: ${item.expirydate}, MRP: ${item.mrp})`;
                            var $option = $('<option>', { value: item.itemcode, text: optionText });
                            $select.append($option);
                    });
                    $select.select2();
                }
            }
        });
    });



 $(document).ready(function () {
            $('#itemcode1').change(function() {
                    //$("#busitem_id").select2();
                    var code = $('#wh2').val();
                     var itemcode = $(this).val();
                     var searchterm = $(this).find(":selected").text();
                    $.ajax({
                      data: {"searchterm":searchterm,'code':code,'itemcode':itemcode,'csrfmiddlewaretoken': '{{ csrf_token }}',},
                      url: "{% url 'get_wh_item' %}",
                      type: 'POST',
                      success: function(data){

                        var obj = data.data
                         console.log(obj);
                          console.log(obj.whmrp);
                        if(obj){
                             $("#quantity").val("");
                            $("#nob").val("");
                            $("#whuom").val(obj.whuom);
                            $("#whmrp").val(obj.whmrp);
                            $("#whuom").val(obj.whuom);
                            $("#whitemname").val(obj.whitemname);
                            $("#whcp_sno").val(obj.whcp_sno);
                            $("#whexpdate").val(obj.whexpirydate);
                             $("#whnob").val(obj.whexpirydate);
                        }
                      },
                      errors: function(e) {
                      alert(e);
                      }
                    })
            })
 })

$('#quantity').on('input', function()  {
            $("#nob").val(" ");
    	    val  = $("#quantity").val();

            val1 = $("#whuom").val();
            val2 =    (val * val1)
            $("#nob").val(val2);
});

 $('#nob').on('input', function()  {
            $("#quantity").val(" ");
    	    val  = $("#nob").val();
            val1 = $("#whuom").val();
            val2 =    (val / val1)
            if (Number.isInteger(val2)) {
                    val2 = val2.toFixed(0); // For integers, remove decimal places
            } else {
                    val2 = val2.toFixed(2); // For decimal values, keep two decimal places
            }
            $("#quantity").val(val2);
 });



 $(document).ready(function () {
            $('#busitemcode').change(function() {
                    //$("#busitem_id").select2();
                    var code = $('#busid2').val();
                     var busitemcode = $(this).val();
                     var searchterm = $(this).find(":selected").text();
                    $.ajax({
                      data: {"searchterm":searchterm,
                      'code':code,'busitemcode':busitemcode,'csrfmiddlewaretoken': '{{ csrf_token }}',},
                      url: "{% url 'get_busstation_item' %}",
                      type: 'POST',
                      success: function(data){

                        var obj = data.data
                         console.log(obj);
                          console.log(obj.busmrp);
                        if(obj){

                            $("#busquantity").val("");
                            $("#busnobt").val("");
                            $("#busmrp").val(obj.busmrp);
                            $("#busuom").val(obj.busuom);
                            $("#busexpdate").val(obj.busexpdate);
                            $("#buscp_sno").val(obj.buscp_sno);

                        }
                      },
                      errors: function(e) {
                      alert(e);
                      }
                    })
            })
 })


$('#busquantity').on('input', function()  {
            $("#busnobt").val(" ");
    	    val  = $("#busquantity").val();
            val1 = $("#busuom").val();
            val2 =    (val * val1)
            $("#busnobt").val(val2);
});

 $('#busnobt').on('input', function()  {
            $("#busquantity").val(" ");
    	    val  = $("#busnobt").val();
            val1 = $("#busuom").val();
            val2 =    (val / val1)
            if (Number.isInteger(val2)) {
                    val2 = val2.toFixed(0); // For integers, remove decimal places
            } else {
                    val2 = val2.toFixed(2); // For decimal values, keep two decimal places
            }
            $("#busquantity").val(val2);
 });


 $(document).ready(function () {
            $('#depot_itemcode').change(function() {
                    var code = $('#depotid3').val();
                     var depoitemcode = $(this).val();
                     var searchterm = $(this).find(":selected").text();

                    $.ajax({
                      data: {"searchterm":searchterm,
                      'code':code,'depoitemcode':depoitemcode,'csrfmiddlewaretoken': '{{ csrf_token }}',},
                      url: "{% url 'get_depo_item' %}",
                      type: 'POST',
                      success: function(data){

                        var obj = data.data
                         console.log(obj);
                          console.log(obj.busmrp);
                        if(obj){
                             $("#depot_quantity").val("");
                              $("#depot_nobt").val("");
                            $("#depot_mrp").val(obj.depot_mrp);
                            $("#depot_uom").val(obj.depot_uom);
                            $("#depotexpdate").val(obj.depotexpdate);
                            $("#depot_sno").val(obj.depot_sno);
                        }
                      },
                      errors: function(e) {
                      alert(e);
                      }
                    })
            })
 })



$('#depot_quantity').on('input', function()  {
            $("#depot_nobt").val(" ");
    	    val  = $("#depot_quantity").val();
            val1 = $("#depot_uom").val();
            val2 =    (val * val1)
            $("#depot_nobt").val(val2);
});

 $('#depot_nobt').on('input', function()  {
            $("#depot_quantity").val(" ");
    	    val  = $("#depot_nobt").val();
            val1 = $("#depot_uom").val();
            val2 =    (val / val1)
            if (Number.isInteger(val2)) {
                    val2 = val2.toFixed(0); // For integers, remove decimal places
            } else {
                    val2 = val2.toFixed(2); // For decimal values, keep two decimal places
            }
            $("#depot_quantity").val(val2);
 });




$(document).ready(function(){
 var response = $('#response').val();
  if ( response === '200') {
         $('.warehouse-div').show();
        $('#items-div').show();
   }
});

$(document).ready(function(){
 var response = $('#response').val();
 var status =  $('#status').val();
  if ( response === '200'  &&  status === 'ok') {
        $('#divItemsAdd').show();
   }
});

$(document).ready(function(){
 var response = $('#response').val();
 var status =  $('#status').val();
 var depotransfer = $("#depotransfer2").val();
 var bus = $('#bustid1').val();
 var wh =$('#warehouse').val();


  if (bus !== 'WDP0001' && bus !== 'WDP0002' &&  bus !== '') {

         $('#bus').show();
          var optionValue1 ="Bus station";

  }
   if (wh == 'WDP0001' || wh == 'WDP0002') {
         $('#depo').show();
          var optionValue1 ="Warehouse";

  }
  if ( response === 'Bus200') {
         $('.bus_div').show();
          $('#items-bus').show();

  }
   if (response === 'Bus200' &&  status === 'ok') {
          $('#bust_items').show();

  }
    if (response === 'depo200') {
          $('.depot-div').show();
          $('#items-depot').show();

  }
  if (response === 'depo503') {
          $('.depot-div').show();
  }
  if (response === 'depo200' &&  status === 'ok') {
          $('#depot_items').show();
  }
 if (depotransfer === 'Warehouse') {
          $("#depo").show();
  }
  if (depotransfer === 'Bus station') {
          $("#bus").show();
  }
});

$('#getdate').val(new Date().toJSON().slice(0,10));
$('.form-control').change(function() {
    console.log('Dropdown value changed');
    if($(this).val() === '') {
    }
  });

$(document).ready(function() {
  $("#wh").on("change", function() {
    var selectedOption = $(this).val();
    if (selectedOption === "Warehouse") {
      $(".warehouse-div").show();
      $(".bus_div").hide();
      $(".depot-div").hide();
      $('#items-depot').hide();
      $('#depot_items').hide();
      $('#items-bus').hide();
      $('#depot_items').hide();
      $('#bust_items').hide();
    } else if (selectedOption === "Depot") {
       $(".depot-div").show();
      $(".warehouse-div").hide();
      $(".bus_div").hide();
      $("#items-div").hide();
      $("#divItemsAdd").hide();
      $('#bust_items').hide();
       $('#items-bus').hide();
    } else if (selectedOption === "Busstation") {
        $(".depot-div").hide();
      $(".bus_div").show();
      $(".warehouse-div").hide();
       $('#items-depot').hide();
       $('#depot_items').hide();
       $("#items-div").hide();
      $("#divItemsAdd").hide();
    }
  });
});

$("#depotransfer1").change(function() {
  var selectedOptionText = $(this).find(":selected").text();
  if (selectedOptionText === "Warehouse") {
    //$("#depowhbus").hide();
    $("#depo").show();
    $("#bus").hide();
  } else if (selectedOptionText === "Bus station") {
    //$("#depowhbus").hide();
    $("#bus").show();
    $("#depo").hide();
  }
});



$(document).ready(function() {
    $("#typeid").on("change", function() {
      var selectedOption = $(this).val();
      if (selectedOption === "Bottles") {
        $("#quantity").prop("readonly", true);
        $("#nob").prop("readonly", false);
      } else if (selectedOption === "Cases") {
        $("#quantity").prop("readonly", false);
        $("#nob").prop("readonly", true);
      }
    });
});


$(document).ready(function() {
    $("#bustypeid").on("change", function() {
      var selectedOption = $(this).val();
      if (selectedOption === "Bottles") {
        $("#busquantity").prop("readonly", true);
        $("#busnobt").prop("readonly", false);
      } else if (selectedOption === "Cases") {
        $("#busquantity").prop("readonly", false);
        $("#busnobt").prop("readonly", true);
      }
    });
 });


$(document).ready(function() {
    $("#depot_typeid").on("change", function() {
      var selectedOption = $(this).val();
      if (selectedOption === "Bottles") {
        $("#depot_quantity").prop("readonly", true);
        $("#depot_nobt").prop("readonly", false);
      } else if (selectedOption === "Cases") {
        $("#depot_quantity").prop("readonly", false);
        $("#depot_nobt").prop("readonly", true);
      }
    });
});

$('#buscomplete').click(function(){
      $('#completeform').attr('action', '{% url  "complete_busstk_admin"  %}'); // set the new action URL
    });
$('#depotcomplete').click(function(){
      $('#completeform').attr('action', '{% url  "complete_depostk_admin"  %}'); // set the new action URL
    });
   $('#getdate1').val(new Date().toJSON().slice(0,10));
   $('.bus_delete').click(function(){
     var sno = $(this).data('sno');
     var modalUrl = '/delete_stkbus_item/' + sno + '/';
     $('#myForm1').attr('action', modalUrl);
    });

     $('.depot_delete').click(function(){
     var sno = $(this).data('sno');
     var modalUrl = '/delete_stkdepo_item/' + sno + '/';
     $('#myForm1').attr('action', modalUrl);
    });
    $('.wh-delete').click(function(){
     var sno = $(this).data('sno');
     var modalUrl = '/delete_stk_item/' + sno + '/';
     $('#myForm1').attr('action', modalUrl);
    });

</script>
{% endblock %}
