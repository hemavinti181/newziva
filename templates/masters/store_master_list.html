{% extends 'base.html' %}

{% block htmlbody %}
<div class="right_col" role="main">

          <div class="">
            <div class="page-title">
              <div class="title_left">
                <h2  class="text-primary"><b>Store Master</b></h2>
              </div>

              <div class="title_right">
                <div class="col-md-6 col-sm-7 offset-md-9">
                    <a href="add_store"><button style="padding: 0px 16px !important;"  width="10%" type="submit" class="btn btn-primary">Add Store</button></a>
                </div>
            </div>
              </div>
            <div class="clearfix"></div>
            <div class="row" style="display: block;">
              <div class="col-md-12 col-sm-12 ">
                <div class="x_panel">
                  <div class="x_content">
                        <table id="datatable-buttons" class="display table-bordered" style="width:100%;">
                         <thead>
                           <tr style="text-color:white">
                                    <th>Store Name</th>
                                    <th>GST No</th>
                                    <th>PAN Card</th>
                                    <th>Trade Licence</th>
                                    <th>Food Licence</th>
                                    <th>Address</th>
                                    <th>Store Location</th>
                                    <th>Action</th>
                           </tr>
                      </thead>
                      <tbody>

                          {% for list in list %}
                        <tr>
                        <td><a href="{{ list.storephoto }}" style="color:#075ab3;" target="_blank">{{ list.storename }}</a></td>
                        <td><a href="{{ list.gstattach }}" style="color:#075ab3;">{{ list.gstnumber}}</a></td>
                        <td><a href="{{ list.panattach }}" style="color:#075ab3;">{{ list.pancard}}</a></td>
                        <td><a href="{{ list.tlattach }}" style="color:#075ab3;">{{ list.tradelicenceno }}</a></td>
                        <td><a href="{{ list.flattach }}" style="color:#075ab3;">{{ list.foodlicence}}</a></td>
                         <td>{{ list.storeaddress}}</a></td>
                        <td><u>{{ list.storelocation }}</u></td>


                                <td>
                                      {% if list.status == "Active" %}

                                    <a class="editstore" href="#"  data-id="{{ list.storecode }}"><i class="fa fa-edit"></i></a>

                                   <a href="store_status_active/{{ list.sno }}/" onclick="return confirm('Are you sure to inactive?')"><span class="badge badge-success" data-toggle="modal" data-target=".bs-example-modal-sm">
                                      Active</span></a>
                                     {% else %}
                                   <a class="editstore" href="#"  data-id="{{ list.warehouseid }}"><i class="fa fa-edit"></i></a>
                                     <a href="store_status_inactive/{{ list.sno }}" onclick="return confirm('Are you sure to active?')"><span class="badge badge-danger" data-toggle="modal" data-target=".bs-example1-modal-sm">
                                      Inactive</span></a>
                                     {% endif %}
                                </td>


                        </tr>
                    {% endfor %}
                      </tbody>
                      </table>
                  </div>
                      <div class="col-md-3 col-sm-3  form-group has-feedback">
										    <input type="hidden" class="form-control"  id="active" name="active">
										</div>
										<div class="col-md-3 col-sm-3  form-group has-feedback">
										    <input type="hidden" class="form-control" id="inactive" name="manufacture">
										</div>

                </div>
              </div>
            </div>
          </div>
</div>
<div id="edit_store" class="modal custom-modal fade"    role="dialog" >
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit Store</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
									<span aria-hidden="true">&times;</span>
								</button>
            </div>
            <div class="modal-body">
                	<form  method="POST" action="store_edit"   enctype="multipart/form-data">
											{% csrf_token %}
										<div class="col-md-4 form-group has-feedback">
                                            <input type="hidden" name="stcode" id="stcode" />
											<label>Store Name *</label>
										    <input type="text" class="form-control"  name="storename" id="storename1" required>
										</div>

										<div class="col-md-4 form-group has-feedback">
											<label>Legal Name *</label>
										    <input type="text" class="form-control"  name=" legalname" id="legalname1" required>
										</div>
										<div  class="col-md-4  form-group has-feedback">
											 <input type="hidden" name="busstationname1" id="busstationname1" />
													<label>Select Busstation</label>
												<select class="form-control" name="busstationid1" id="busstationid1" >
													{% for data1 in bus %}
                            		                  <option value="{{ data1.busatationid }}" selected>{{ data1.busstationname }}</option>
                                                    {% endfor %}
												</select>
										</div>
										<div class="col-md-4 form-group has-feedback">
											<label>GST Number *</label>
										    <input type="text" class="form-control" name="gstnumber" id="gstnumber1" required>
										</div>



										<div class="col-md-4  form-group has-feedback">
											<label>PAN Card *</label>
										    <input type="text" class="form-control" name="pancard" id="pancard1"  required>
										</div>

										<div class="col-md-4   form-group has-feedback">
											<label>Trade Licence *</label>
										    <input type="text" class="form-control" name="tradelicenceno" id="tradelicenceno1" required>
										</div>

											<div class="col-md-4  form-group has-feedback">
												<label>Food Licence *</label>
										    	<input type="text" class="form-control" name="foodlicence" id="foodlicence1"  required>
											</div>
										<div class="col-md-4   form-group has-feedback"><label>Address *</label>
										    <input type="text" class="form-control" name="storeaddress"  id="storeaddress1"required>
										</div>
										<div class="col-md-4   form-group has-feedback">
											<label>Pincode *</label>
										    <input type="text" class="form-control" name="pincode" id="pincode1" patern="[0-9][0-9]{5}" maxlength="6" autocomplete="off"  value="{{data.pincode}}" required>
										</div>

												<div  class="col-md-4   form-group has-feedback">
													<label>State list *</label>
													<select class="form-control" name="state" id="state1">
														{% for state in state %}
															<option  value="{{ state.sno}}">{{ state.displayname }}</option>
														{% endfor %}
													</select>
												</div>

										<div class="col-md-4  form-group has-feedback">
											<label>Contact Person *</label>
										    <input type="text" class="form-control" id="contactperson1" name="contactperson" required>
										</div>
										<div class="col-md-4  form-group has-feedback">
											<label>Mobile *</label>
										    <input type="text" class="form-control" id="mobileno1" name="mobileno" required>
										</div>


										<!--<div class="col-md-6   form-group has-feedback">
											<label>Food Attach *</label>
    											<input type="file"  name="flattach"id="customFile4"  value="{{data.flattach}}" required>
										</div>
										<div class="col-md-6  form-group has-feedback">
											<label>GST Attach</label>
    											<input type="file"  name="gstattach" id="customFile5"  value="{{data.gstattach}}"required >
										</div>
						                <div class="col-md-6  form-group has-feedback">
											<label>Store File Attach *</label>
    											<input type="file"  name='storephoto' id="storephoto" value="{{data.storephoto}}" required>
										</div>
										<div class="col-md-6 form-group has-feedback">
											<label>Trade Attach *</label>
    											<input type="file"  name="tlattach" id="customFile"  value="{{data.tlattach}}" required >
										</div>-->
                                        <div class="col-md-4  form-group has-feedback">
											<label>Email *</label>
										    <input type="email" name="email" id="email1" class="form-control" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" required>
											</div>
										<div class="col-md-6 form-group has-feedback">
											<label class="col-form-label col-md-3 col-sm-3 ">Remarks*</label>
											<textarea   name="remarks" id="remarks1" class="form-control"  rows="2" required></textarea>
										</div>

                                        <input type="hidden" name="storelocation" id="storelocation" />

			</div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-primary">Update</button>
            </div>
          </form>
        </div>
	</div>
</div>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script>
$(document).ready(function() {
    $('.editstore').click(function() {
      var id = $(this).data('id');
      $.ajax({
        url: "{% url 'get_store' %}",
        type: 'POST',
        data: {
          'id': id,'csrfmiddlewaretoken': '{{ csrf_token }}',
        },
        success: function(data) {
         var obj = data.data
          	console.log(obj.state);
             if(obj){
             $("#stcode").val(obj.storecode);
             $("#storename1").val(obj.storename);
             $("#legalname1").val(obj.legal_name);
             $("#gstnumber1").val(obj.gstnumber);
             $("#pancard1").val(obj.pancard);
             $("#tradelicenceno1").val(obj.tradelicenceno);
             $("#foodlicence1").val(obj.foodlicence);
             $("#storeaddress1").val(obj.storeaddress);
             $("#pincode1").val(obj.pincode);
             $("#contactperson1").val(obj.contact_person);
             $("#mobileno1").val(obj.mobile_no);
             $("#remarks1").val(obj.remarks);
             $("#state1").val(obj.state);
             $("#email1").val(obj.email);
             $("#storelocation").val(obj.storelocation);
             $('#edit_store').modal('show');
        	}
        }
      });
    });
  });
$("#busstationid1").change(function() {
  var selectedOptionText = $(this).find(":selected").text();
  $("#busstationname1").val(selectedOptionText);
});

</script>
{% endblock %}

