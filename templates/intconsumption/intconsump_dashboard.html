{% extends 'base.html' %}

{% block htmlbody %}


<style>
      .design{
     color: white;
        background-color:#0876A2 !important;
    }
      .design1{
        color: white;
        background-color:#0876A2 !important;
    }
     #completetabel:hover{
    overflow-x:scroll !important;
    }
    #stktabel:hover{
    overflow-x:scroll !important;
    }

</style>


<div class="right_col" role="main">
<div class="row">
              <div class="col-md-12 col-sm-12 ">

          <div class="page-title">
            <div class="title_left">
              <h3 style="font-size:20px; font-weight:600;">Internal Consumption  Dashboard</h3>
            </div>
          </div>

                   <div class="x_panel">
				      	<form  method="POST" action=""   enctype="multipart/form-data">
											{% csrf_token %}
                            	<div  class="col-md-3 col-sm-3  form-group has-feedback">
													<label> Depot</label>
												 <select class="form-control items" name="depoid" id="depoid" required>
                                                     <option value="All">All</option>
                                                    {% for data in depolist %}
                                                        {% if data.status == "Active" %}
                                                                <option value="{{ data.depoid }}">{{ data.deponame }}</option>
                                                        {% endif %}
                                                    {% endfor %}
                                                </select>
                                </div>


                        </form>
                   </div>
                        <div class="col-md-4 col-sm-4 ">
        <div class="x_panel">
          <div class="page-title">
            <div class="title_left">
              <h3 style="font-size:20px; font-weight:600;">Available Stock</h3>
            </div>
            <div class="title_right">
               <div class="col-md-6 col-sm-7 offset-md-9">
                <!--<label><input type="checkbox" id="checked1" class="js-switch"  /></label>-->
              </div>
            </div>
          </div>

             <!--<div class="col-md-6 col-sm-6  form-group has-feedback">

										    	 <select class="form-control items" name="itemcode" id="itemcode" required>
                                                     <option value="All">All</option>
                                                    {% for data in item_masterlist %}
                                                        {% if data.status == "Active" %}
                                                                <option value="{{ data.itemcode }}">{{ data.itemname }}</option>
                                                        {% endif %}
                                                    {% endfor %}
                                                </select>
										</div>-->
          <div class="x_content stockchart">
            <div class="animated flipInY col-lg-4 col-md-4 col-sm-4">
              <div class="tile-stats">
                <div class="count stock_cases" style="color: #14c38e;text-align:center;margin-left: auto;margin-right: auto;font-size:20px;"></div>
                <div style="text-align:center;margin-left: auto;margin-right: auto;">Qty (Cases)</div>
                <p class="d-none"><span class="glyphicon glyphicon-ok-circle" aria-hidden="true"></span>stock on hand</p>
              </div>
            </div>
            <div class="animated flipInY col-lg-4 col-md-4 col-sm-4">
              <div class="tile-stats">
                <div class="count stock_botteles" style="color:#14c38e;text-align:center;margin-left: auto;margin-right: auto;font-size:20px;"></div>
                <div style="text-align:center;margin-left: auto;margin-right: auto;">Qty (Bottles)</div>
                <p class="d-none"><span class="glyphicon glyphicon-download" aria-hidden="true"></span>stock on hand</p>
              </div>
            </div>
            <div class="animated flipInY col-lg-4 col-md-4 col-sm-4">
              <div class="tile-stats">
                <div class="count indays" style="color:#14c38e ;text-align:center;margin-left: auto;margin-right: auto;font-size:20px;">{{ total. }}</div>
                <div style="text-align:center;margin-left: auto;margin-right: auto;">(Days)</div>
                <p class="d-none"><span class="glyphicon glyphicon-ok-circle" aria-hidden="true"></span>Available Up to </p>
              </div>
            </div>
            <div class="animated flipInY col-lg-6 col-md-6 col-sm-6">
              <div class="tile-stats">
                <div class="count consumption_cases" style="color:#14c38e;text-align:center;margin-left: auto;margin-right: auto;font-size:20px;"></div>
                <div style="text-align:center;margin-left: auto;margin-right: auto;">Qty (Cases)</div>
                <p><span class="fa fa-info" aria-hidden="true"></span> Avg consumption of last 7 days</p>
              </div>
            </div>
            <div class="animated flipInY col-lg-6 col-md-6 col-sm-6">
              <div class="tile-stats">
                <div class="count consumption_botteles" style="color:#14c38e;text-align:center;margin-left: auto;margin-right: auto;font-size:20px;"></div>
                <div style="text-align:center;margin-left: auto;margin-right: auto;">Qty (Bottles)</div>
                <p><span class="fa fa-info" aria-hidden="true"></span>Avg consumption of last 7days</p>
              </div>
            </div>
            <div class="clearfix"></div>

            <div class="x_content">
              <div class="row">
                <div class="col-sm-12">
                     <div class="col-md-12 col-sm-12 echart-depot2" style="margin-bottom:35px;">
                  <h3 style="margin: 125px 3px 149px 100px;display:none;" id="lblNoStock2">No Stock Available</h3>
                       <div id="echart-depot2" style="height:365px;margin-top:-60px;margin-left:-100px;width:600px"></div>
              </div>
                  <div class="card-box table-responsive" style="overflow:hidden">
                    <p class="text-muted font-13 m-b-30">
                    </p>

                <div class="clearfix"></div>
                    <!--<table id="datatable-buttons" class="display table-striped table-bordered" style="width:100%">-->
                                      <table   class="table table-striped table-responsive jambo_table bulk_action"  style="display:none;overflow:hidden;" id="stktabel" >
                      <thead>
                        <tr>
                          <th class="design1" rowspan="2">#</th>
                          <th class="design1" rowspan="2">Items</th>
                          <th class="design1" colspan="2">Available Stock</th>
                          <th class="design1" colspan="2">Avg Consumption of last 7 days </th>
                          <th colspan="2" class="design1" rowspan="2">Days of stock Available</th>
                        </tr>
                        <tr>
                          <th class="design">Qty( Cases)</th>
                          <th class="design">Qty( Bottles)</th>
                          <th class="design">Qty( Cases)</th>
                          <th class="design">Qty( Bottles)</th>
                        </tr>
                      </thead>
                      <tbody>
                      </tbody>
                      <tfoot>
                        <tr>
                        </tr>
                      </tfoot>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4 col-sm-4 ">
            <div class="x_panel">
          <div class="page-title">
            <div class="title_left">
              <h6 style="color:#14c38e;font-weight:600;font-size:18px;">Stock Issues To Services</h6>
            </div>
          </div>

          <div class="x_content" style="margin-top:-21px">
        <form  method="POST" action="/intconsump_dashboard_data"  id="myForm" enctype="multipart/form-data">
									{% csrf_token %}
             <div class="col-md-6 col-sm-6  form-group has-feedback">
                 <input class="form-control" type="date" name="fdate"  id="fdate"  value="{{ request.POST.fdate }}"  required>
             </div>
             <div class="col-md-6 col-sm-  form-group has-feedback">
                 <input class="form-control" type="date" name="tdate"  id="tdate"  value="{{ request.POST.tdate }}" required>
             </div>

              <p></p>
            <div class="animated flipInY col-lg-4 col-md-4 col-sm-4">
              <div class="tile-stats">
                <div class="count issued_bottles" style="color: #14c38e;text-align:center;margin-left: auto;margin-right: auto;font-size:20px;"></div>
                <div style="text-align:center;margin-left: auto;margin-right: auto;margin-bottom: 20px;">Issued(Bottles)</div>
                <p class="d-none"><span class="glyphicon glyphicon-ok-circle" aria-hidden="true"></span>stock on hand</p>
              </div>
            </div>
            <div class="animated flipInY col-lg-4 col-md-4 col-sm-4">
              <div class="tile-stats">
                <div class="count consumed_botteles" style="color:#14c38e;text-align:center;margin-left: auto;margin-right: auto;font-size:20px;"></div>
                <div style="text-align:center;margin-left: auto;margin-right: auto;margin-bottom: 18px;">Services</div>
                <p class="d-none"><span class="glyphicon glyphicon-download" aria-hidden="true"></span>stock on hand</p>
              </div>
            </div>
            <div class="animated flipInY col-lg-4 col-md-4 col-sm-4">
              <div class="tile-stats">
                <div class="count shortage" style="color: #14c38e;text-align:center;margin-left: auto;margin-right: auto;font-size:20px;"></div>
                <div style="text-align:center;margin-left: auto;margin-right: auto;margin-bottom: 20px;">Shortage</div>
                <p class="d-none"><span class="glyphicon glyphicon-ok-circle" aria-hidden="true"></span>Available Up to </p>
              </div>
            </div>
            <div class="animated flipInY col-lg-6 col-md-6 col-sm-6">
              <div class="tile-stats">
                <div class="count tobe_return" style="color:#14c38e;text-align:center;margin-left: auto;margin-right: auto;font-size:20px;"></div>
                <div style="text-align:center;margin-left: auto;margin-right: auto;"></div>
                <p><span class="fa fa-info" aria-hidden="true" style="margin-bottom:10px;"></span> To Be Returned</p>
              </div>
            </div>
            <div class="animated flipInY col-lg-6 col-md-6 col-sm-6">
              <div class="tile-stats">
                <div class="count passenger" style="color:#14c38e;text-align:center;margin-left: auto;margin-right: auto;font-size:20px;"></div>
                <div style="text-align:center;margin-left: auto;margin-right: auto"></div>
                <p><span class="fa fa-info" aria-hidden="true" style="margin-bottom:10px;"></span> Passengers </p>
              </div>
            </div>
            <div class="clearfix"></div>

            <div class="x_content">
              <div class="row">
                <div class="col-sm-12">
                  <div class="card-box table-responsive" style="overflow:hidden">
                    <p class="text-muted font-13 m-b-30">
                    </p>
                <div class="col-md-12 col-sm-12 echart-depot1" style="margin-bottom:10px;">
                  <h3 style="margin: 125px 3px 149px 100px;display:none;" id="lblNoStock">No Consumption Available</h3>
                       <div id="echart-depot1" style="height:350px;margin-top:-60px;margin-left:-100px;width:600px"></div>
              </div>
                <div class="clearfix"></div>
                    <!--<table id="datatable-buttons" class="display table-striped table-bordered" style="width:100%">-->
                                      <table   class="table table-striped table-responsive jambo_table bulk_action"  style="display:none;overflow:hidden;" id="stktabel" >
                      <thead>
                        <tr>
                          <th class="design" rowspan="2">#</th>
                          <th class="design" rowspan="2">Items</th>
                          <th class="design" colspan="2">Available Stock</th>
                          <th class="design" colspan="2">Avg Consumption of last 7 days </th>
                          <th colspan="2" class="design" rowspan="2">Days of stock Available</th>
                        </tr>
                        <tr>
                          <th class="design">Qty (Cases)</th>
                          <th class="design">Qty (Bottles)</th>
                          <th class="design">Qty (Cases)</th>
                          <th class="design">Qty (Bottles)</th>
                        </tr>
                      </thead>
                      <tbody>
                      </tbody>
                      <tfoot>
                        <tr>
                        </tr>
                      </tfoot>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
           <div class="clearfix"></div>
        </div>
      </div>
              </div>

</div>
</div>

<script>
    var chart_gauge_sales_elem;
    var chart_gauge_01;
    var item_gauge;

var chart_gauge_settings = {
          lines: 12,
          angle: 0,
          lineWidth: 0.4,
          pointer: {
              length: 0.75,
              strokeWidth: 0.042,
              color: '#1D212A'
          },
          limitMax: 'false',
          colorStart: '#0C893B',
          colorStop: '#0C893B',
          strokeColor: '#0876A2',
          generateGradient: true
      };
    var theme = {
        color: [
            '#0876A2 ', '#FFC300 ', '#14c38e', '#bfd3b7',
            '#9B59B6', '#8abb6f', '#759c6a', '#bfd3b7'
        ],

        title: {
            itemGap: 8,
            textStyle: {
                fontWeight: 'normal',
                color: '#408829'
            }
        },

        dataRange: {
            color: ['#1f610a', '#97b58d']
        },

        toolbox: {
            color: ['#408829', '#408829', '#408829', '#408829']
        },

        tooltip: {
            backgroundColor: 'rgba(0,0,0,0.5)',
            axisPointer: {
                type: 'line',
                lineStyle: {
                    color: '#408829',
                    type: 'dashed'
                },
                crossStyle: {
                    color: '#408829'
                },
                shadowStyle: {
                    color: 'rgba(200,200,200,0.3)'
                }
            }
        },

        dataZoom: {
            dataBackgroundColor: '#eee',
            fillerColor: 'rgba(64,136,41,0.2)',
            handleColor: '#408829'
        },
        grid: {
            borderWidth: 0
        },

        categoryAxis: {
            axisLine: {
                lineStyle: {
                    color: '#408829'
                }
            },
            splitLine: {
                lineStyle: {
                    color: ['#eee']
                }
            }
        },

        valueAxis: {
            axisLine: {
                lineStyle: {
                    color: '#408829'
                }
            },
            splitArea: {
                show: true,
                areaStyle: {
                    color: ['rgba(250,250,250,0.1)', 'rgba(200,200,200,0.1)']
                }
            },
            splitLine: {
                lineStyle: {
                    color: ['#eee']
                }
            }
        },
        timeline: {
            lineStyle: {
                color: '#408829'
            },
            controlStyle: {
                normal: { color: '#408829' },
                emphasis: { color: '#408829' }
            }
        },

        k: {
            itemStyle: {
                normal: {
                    color: '#68a54a',
                    color0: '#a9cba2',
                    lineStyle: {
                        width: 1,
                        color: '#408829',
                        color0: '#86b379'
                    }
                }
            }
        },
        map: {
            itemStyle: {
                normal: {
                    areaStyle: {
                        color: '#ddd'
                    },
                    label: {
                        textStyle: {
                            color: '#c12e34'
                        }
                    }
                },
                emphasis: {
                    areaStyle: {
                        color: '#99d2dd'
                    },
                    label: {
                        textStyle: {
                            color: '#c12e34'
                        }
                    }
                }
            }
        },
        force: {
            itemStyle: {
                normal: {
                    linkStyle: {
                        strokeColor: '#408829'
                    }
                }
            }
        },
        chord: {
            padding: 4,
            itemStyle: {
                normal: {
                    lineStyle: {
                        width: 1,
                        color: 'rgba(128, 128, 128, 0.5)'
                    },
                    chordStyle: {
                        lineStyle: {
                            width: 1,
                            color: 'rgba(128, 128, 128, 0.5)'
                        }
                    }
                },
                emphasis: {
                    lineStyle: {
                        width: 1,
                        color: 'rgba(128, 128, 128, 0.5)'
                    },
                    chordStyle: {
                        lineStyle: {
                            width: 1,
                            color: 'rgba(128, 128, 128, 0.5)'
                        }
                    }
                }
            }
        },
        gauge: {
            startAngle: 225,
            endAngle: -45,
            axisLine: {
                show: true,
                lineStyle: {
                    color: [[0.2, '#86b379'], [0.8, '#68a54a'], [1, '#408829']],
                    width: 8
                }
            },
            axisTick: {
                splitNumber: 10,
                length: 12,
                lineStyle: {
                    color: 'auto'
                }
            },
            axisLabel: {
                textStyle: {
                    color: 'auto'
                }
            },
            splitLine: {
                length: 18,
                lineStyle: {
                    color: 'auto'
                }
            },
            pointer: {
                length: '90%',
                color: 'auto'
            },
            title: {
                textStyle: {
                    color: '#333'
                }
            },
            detail: {
                textStyle: {
                    color: 'auto'
                }
            }
        },
        textStyle: {
            fontFamily: 'Arial, Verdana, sans-serif'
        }
    };

$('#fdate').val(new Date().toJSON().slice(0,10));
$('#tdate').val(new Date().toJSON().slice(0,10));

 function updateEchartPieChart1(total) {
        var echartPie = echarts.init(document.getElementById('echart-depot2'),theme);
          var count = 0;
          if($("#checked2").prop('checked')){
              $(".echart-depot2").show();
          }
          var seriesData = [];
          var legendData = [];

          for (var i = 0; i < total.length; i++) {
            var item = total[i];
              if(item.stock_botteles!="0"){
               seriesData.push({
                 value: item.stock_cases,
                 name: item.itemname
               });
               count++;
            }
            legendData.push(item.itemname);

          }
           if (count === 0) {
              $('#echart-depot2').hide();
              $('#lblNoStock2').show();
          } else {
              $('#echart-depot2').show();
              $('#lblNoStock2').hide();
          }

          echartPie.setOption({
              tooltip: {
                  trigger: 'item',
                  formatter: "{a} <br/>{b} : {c} ({d}%)"
              },
              legend: {
                  x: 'center',
                  y: 'bottom',
                  data: legendData
              },
              toolbox: {
                  show: true,
                  feature: {
                      magicType: {
                          show: true,
                          type: ['pie', 'funnel'],
                          option: {
                              funnel: {
                                  x: '25%',
                                  width: '50%',
                                  funnelAlign: 'left',
                                  max: 1548
                              }
                          }
                      },

                  }
              },
              calculable: true,
                series: [{
                  name: 'Chart',
                  type: 'pie',
                  radius: '55%',
                  center: ['50%', '48%'],
                  data: seriesData // Use the processed 'seriesData' array
                }]
          });

          var dataStyle = {
              normal: {
                  label: {
                      show: false
                  },
                  labelLine: {
                      show: false
                  }
              }
          };

          var placeHolderStyle = {
              normal: {
                  color: 'rgba(0,0,0,0)',
                  label: {
                      show: false
                  },
                  labelLine: {
                      show: false
                  }
              },
              emphasis: {
                  color: 'rgba(0,0,0,0)'
              }
          };
 if($("#checked2").prop('checked')){
              $(".echart-depot2").hide();
          }

}

function updateEchartPieChart_depot(total) {
        var echartPie = echarts.init(document.getElementById('echart-depot2'),theme);
          var count = 0;
          if($("#checked2").prop('checked')){
              $(".echart-depot2").show();

          }
          var seriesData = [];
          var legendData = [];

          // Process 'itemslist' data and populate 'seriesData' and 'legendData'

          for (var i = 0; i < total.length; i++) {
            var item = total[i];
              if(item.stock_botteles!="0"){
               seriesData.push({
                 value: item.stock_cases,
                 name: item.itemname
               });
               count++;
            }
            legendData.push(item.itemname);

          }
           if (count === 0) {
              $('#echart-depot2').hide();
              $('#lblNoStock2').show();
          } else {
              $('#echart-depot2').show();
              $('#lblNoStock2').hide();
          }
          echartPie.setOption({
              tooltip: {
                  trigger: 'item',
                  formatter: "{a} <br/>{b} : {c} ({d}%)"
              },
              legend: {
                  x: 'center',
                  y: 'bottom',
                  data: legendData
              },
              toolbox: {
                  show: true,
                  feature: {
                      magicType: {
                          show: true,
                          type: ['pie', 'funnel'],
                          option: {
                              funnel: {
                                  x: '25%',
                                  width: '50%',
                                  funnelAlign: 'left',
                                  max: 1548
                              }
                          }
                      },

                  }
              },
              calculable: true,
                series: [{
                  name: 'Chart',
                  type: 'pie',
                  radius: '55%',
                  center: ['50%', '48%'],
                  data: seriesData // Use the processed 'seriesData' array
                }]
          });

          var dataStyle = {
              normal: {
                  label: {
                      show: false
                  },
                  labelLine: {
                      show: false
                  }
              }
          };

          var placeHolderStyle = {
              normal: {
                  color: 'rgba(0,0,0,0)',
                  label: {
                      show: false
                  },
                  labelLine: {
                      show: false
                  }
              },
              emphasis: {
                  color: 'rgba(0,0,0,0)'
              }
          };

        if($("#checked2").prop('checked')){
              $(".echart-depot2").show();

          }

}

function updateEchartPieChart(itemslist) {

        var echartPie = echarts.init(document.getElementById('echart-depot1'),theme);
          var count=0;

          var seriesData = [];
          var legendData = [];

            var item = itemslist;
              if(item[0].issued != "0" ){
               seriesData.push({
                 value: item[0].issued,
                 name: 'Issued'
               });
                 count++;
               }
               if(item[0].consumed != "0" ){
               seriesData.push({
                 value: item[0].consumed,
                 name: 'Consumed'
               });
                 count++;
               }
                if(item[0].shortage!="0" ){
               seriesData.push({
                    value: item[0].shortage,
                    name: 'Shortage'
                });
                  count++;
               }

            legendData.push('Issued','Consumed','Shortage');

          if(count === 0){
          $("#echart-depot1").hide();
           $("#lblNoStock").show();
          }

          else{
           $("#echart-depot1").show();
           $("#lblNoStock").hide();
          }
          echartPie.setOption({
              tooltip: {
                  trigger: 'item',
                  formatter: "{a} <br/>{b} : {c} ({d}%)"
              },
              legend: {
                  x: 'center',
                  y: 'bottom',
                  data: legendData
              },
              toolbox: {
                  show: true,
                  feature: {
                      magicType: {
                          show: true,
                          type: ['pie', 'funnel'],
                          option: {
                              funnel: {
                                  x: '25%',
                                  width: '50%',
                                  funnelAlign: 'left',
                                  max: 1548
                              }
                          }
                      },

                  }
              },
              calculable: true,
                series: [{
                  name: 'Chart',
                  type: 'pie',
                  radius: '55%',
                  center: ['50%', '48%'],
                  data: seriesData // Use the processed 'seriesData' array
                }]
          });

          var dataStyle = {
              normal: {
                  label: {
                      show: false
                  },
                  labelLine: {
                      show: false
                  }
              }
          };

          var placeHolderStyle = {
              normal: {
                  color: 'rgba(0,0,0,0)',
                  label: {
                      show: false
                  },
                  labelLine: {
                      show: false
                  }
              },
              emphasis: {
                  color: 'rgba(0,0,0,0)'
              }
          };
 }


$(document).ready(function() {
depoid = $('#depoid').find(":selected").text();
$.ajax({
  type: "POST",
  url: "{% url 'intconsump_dashboard_data' %}",
  data: {
   'csrfmiddlewaretoken': '{{ csrf_token }}','depoid':depoid,
  },
  success: function(data) {
     var itemslist =  data.data.consumptionlist;
     message = data.data.message
      if(message != "data found")
      {
       $("#lblNoStock").show();
       $("#echart-depot1").hide();
      }else{
       updateEchartPieChart(itemslist);
      }

                    $('.issued_bottles').text(itemslist[0].issued);
                    $('.consumed_botteles').text(itemslist[0].no_of_services);
                    $('.shortage').text(itemslist[0].shortage);
                    $('.tobe_return').text(itemslist[0].no_of_tickets);
                    $('.passenger').text(itemslist[0].no_of_tickets);

  },
  error: function(jqXHR, textStatus, errorThrown) {
    console.error("Error occurred: " + textStatus, errorThrown);
    // Handle the error case here, if required
  }
});
});


$("#fdate, #tdate").change(function() {
 depoid = $('#depoid').find(":selected").text();
 fdate = $('#fdate').val();
 tdate = $('#tdate').val();
  $.ajax({
  type: "POST",
  url: "{% url 'intconsump_dashboard_data' %}",
  data: {
  'fdate':fdate,'cdate':tdate,'depoid':depoid,'csrfmiddlewaretoken': '{{ csrf_token }}',
  },
  success: function(data) {
     var itemslist =  data.data.consumptionlist;
     message = data.data.message
     console.log(message);
      if(message != "data found")
      {
       $("#lblNoStock").show();
       $("#echart-depot1").hide();
      }else{
       updateEchartPieChart(itemslist);
      }

                    $('.issued_bottles').text(itemslist[0].issued);
                    $('.consumed_botteles').text(itemslist[0].consumed);
                    $('.shortage').text(itemslist.shortage);[0]
                    $('.tobe_return').text(itemslist[0].no_of_tickets);
                    $('.passenger').text(itemslist[0].no_of_tickets);


  },
  error: function(jqXHR, textStatus, errorThrown) {
    console.error("Error occurred: " + textStatus, errorThrown);
    // Handle the error case here, if required
  }
});
});




$("#depoid").change(function() {
 depoid = $('#depoid').find(":selected").text();
 fdate = $('#fdate').val();
 tdate = $('#tdate').val();
  $.ajax({
  type: "POST",
  url: "{% url 'intconsump_dashboard_data' %}",
  data: {
  'fdate':fdate,'cdate':tdate,'depoid':depoid, 'csrfmiddlewaretoken': '{{ csrf_token }}',
  },
  success: function(data) {
     var itemslist =  data.data.consumptionlist;
     message = data.data.message
     console.log(message);
      if(message != "data found")
      {
       $("#lblNoStock").show();
       $("#echart-depot1").hide();
      }else{
       updateEchartPieChart(itemslist);
      }

                     $('.issued_bottles').text(itemslist[0].issued);
                    $('.consumed_botteles').text(itemslist[0].consumed);
                    $('.shortage').text(itemslist[0].shortage);
                    $('.tobe_return').text(itemslist[0].no_of_tickets);
                    $('.passenger').text(itemslist[0].no_of_tickets);

  },
  error: function(jqXHR, textStatus, errorThrown) {
    console.error("Error occurred: " + textStatus, errorThrown);
    // Handle the error case here, if required
  }
});
});


$(document).ready(function() {
    $("#checked1").click(function() {
      if ($(this).is(":checked")) {
       $(".echart-depot2").hide();
      $("#stktabel").show();
    }
    else{
     $(".echart-depot2").show();
      $("#stktabel").hide();
    }
    });
});



$(document).ready(function() {
var depoid = $('#depoid').val();
$.ajax({
  type: "POST",
  url: "{% url 'internal_consump_stock' %}",
  data: {
  'depoid':depoid, 'csrfmiddlewaretoken': '{{ csrf_token }}'
  },
  success: function(data) {
     var total =  data.data.totallist;
     message = data.data.message
      console.log(data);

      if(message != "Data found")
      {
       $("#lblNoStock").html(data.message);
       $("#lblNoStock").show();
       $("#echart-depot1").hide();
      }else{
         updateEchartPieChart1(total);
      }
      for (var i = 0; i < total.length; i++) {
                  var item = total[i];
                  $('.stock_cases').text(item.stock_cases);
                  $('.stock_botteles').text(item.stock_botteles);
                  $('.consumption_cases').text(item.consumption_cases);
                  $('.consumption_botteles').text(item.consumption_botteles);
                  $('.indays').text(item.indays);

      }

  },
  error: function(jqXHR, textStatus, errorThrown) {
    console.error("Error occurred: " + textStatus, errorThrown);
    // Handle the error case here, if required
  }
});
});


$('#depoid').change(function() {
var depoid = $('#depoid').val();
$.ajax({
  type: "POST",
  url: "{% url 'internal_consump_stock' %}",
  data: {
  'depoid':depoid, 'csrfmiddlewaretoken': '{{ csrf_token }}'
  },
  success: function(data) {
     var total =  data.data.totallist;
     message = data.data.message
      console.log(data);

      if(message != "Data found")
      {
       $("#lblNoStock").html(data.message);
       $("#lblNoStock").show();
       $("#echart-depot1").hide();
      }else{
         updateEchartPieChart1(total);
      }
      for (var i = 0; i < total.length; i++) {
                  var item = total[i];
                  $('.stock_cases').text(item.stock_cases);
                  $('.stock_botteles').text(item.stock_botteles);
                  $('.consumption_cases').text(item.consumption_cases);
                  $('.consumption_botteles').text(item.consumption_botteles);
                  $('.indays').text(item.indays);

      }

  },
  error: function(jqXHR, textStatus, errorThrown) {
    console.error("Error occurred: " + textStatus, errorThrown);
    // Handle the error case here, if required
  }
});
});



</script>

{% endblock %}